<% page_title "#{@representative.full_name} - #{Representative.model_name.human(count: 2).capitalize} - #{t('app.title')}" %>
<% party = @representative.latest_party %>

<div class="representative-profile">

  <%= image_tag @representative.image.versions[:large], width: '240', height: '320', class: 'representative-image', alt: @representative.full_name %>

  <h1 class="representative-name"><%= @representative.full_name %> (<%= @representative.age %>)</h1>

  <aside>
    <span class="representative-district">
      <%= link_to @representative.district.name, @representative.district %>
    </span>
    <span class="representative-party">
      <%= party && link_to(party.name, party, class: party.external_id) %>
    </span>

    <% unless @representative.attending? %>
      <p class="muted"><%= Representative.human_attribute_name(:not_attending) %></p>
    <% end %>

    <dl class="representative-committee-list">
      <% @representative.current_committees.each do |com| %>
        <dd>Medlem av <%= link_to com.name, com %></dd>
      <% end %>
    </dl>

    <% if @representative.askable? %>
      <%= link_to t('app.questions.representative.ask', name: @representative.name),
                  new_question_path(representative: @representative.slug, district: @representative.district.slug),
                  class: 'btn btn-primary' %>
    <% end %>
  </aside>
</div>

<hr class="soften">

<div class="row-fluid">
  <div class="span6 <%= @representative.askable? ? '' : 'muted' %>">
    <h3>Spørsmål fra velgerne</h3>
    <% if @representative.askable? %>
      <%= render partial: 'question_list', locals: { representative: @representative, questions: @questions } %>
    <% elsif @representative.opted_out? %>
      <p><%= @representative.name %> har reservert seg mot å svare på spørsmål.</p>
    <% elsif @representative.attending? && @representative.email.nil? %>
      <p><%= @representative.name %> møter for tiden på Stortinget, men vi mangler epostaddressen.</p>
      <p>Dette skal helst ikke skje, så gi oss gjerne beskjed <%= mail_to AppConfig.question_answer_email, 'her!', encode: 'hex', subject: "Mangler epost for #{@representative.name} (#{@representative.external_id})" %>.</p>
    <% else %>
      <p><%= @representative.name %> møter for tiden ikke på Stortinget. Du kan bare stille spørsmål til møtende representanter.</p>
    <% end %>
  </div>

  <div class="span6">
    <% if @representative.has_twitter? %>
      <h3>
        Twitter <%= link_to "(@#{@representative.twitter_id})", @representative.twitter_url, class: 'muted' %>
      </h3>

      <%= twitter_widget_for(@representative.twitter_id) %>
    <% end %>
  </div>
</div>

<hr>

<%= render partial: 'issue_positions', locals: { issue_groups: @issue_groups, representative: @representative } %>
