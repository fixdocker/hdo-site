<h2>Forslagsvask</h2>

<div class="progress">
  <div class="bar bar-success" style="width: <%= @stats.published_percentage %>%;"><%= @stats.published %> publiserte</div>
  <div class="bar bar-warning" style="width: <%= @stats.pending_percentage %>%;"><%= @stats.pending %> nye</div>
</div>

<hr>

<section class="proposition-index">
  <div class="row-fluid">
    <div class="span8">
      <ul class="nav nav-tabs">
        <li class="<%= 'active' if params[:status].blank? %>">
          <%= link_to "Alle forslag (#{@stats.total})", admin_propositions_path %>
        </li>

        <li class="<%= 'active' if params[:status] == 'published' %>">
          <%= link_to "Publiserte (#{@stats.published})", admin_propositions_path(status: 'published') %>
        </li>

        <li class="<%= 'active' if params[:status] == 'pending' %>">
          <%= link_to "Nye (#{@stats.pending})", admin_propositions_path(status: 'pending') %>
        </li>
      </ul>
    </div>

    <div class="span4">
      <div class="input-append pull-right">
        <input type="search"
               id="proposition-query"
               class="input-medium search-query"
               placeholder="SÃ¸k i forslag"
               autofocus>
      </div>
    </div>
  </div>

  <div class="row-fluid">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th class="wide-table-header">Importert</th>
          <th>Status</th>
          <th>Fra</th>
          <th>Forslagstittel</th>
          <th>Forslagstekst</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% @propositions.each do |prop| %>
          <tr class="<%= prop.status == 'published' ? 'success' : 'warning' %>">
            <td><%= l prop.created_at, format: :short_text %></td>
            <td><%= prop.status_text %></td>
            <td><%= prop.on_behalf_of_guess.join(',') %></td>
            <td><%= prop.description %></td>
            <td><%= prop.short_body %></td>
            <td><%= link_to 'Rediger', edit_admin_proposition_path(prop), class: 'btn btn-small' %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <%= will_paginate @propositions, class: "pagination pagination-centered" %>
</section>

<%= content_for :document_ready do %>
<script>
$(function () {
  $("#proposition-query").keypress(function (e) {
    if (e.keyCode != 13) {
      return;
    }

    alert('Not yet implemented.');
  })
})
</script>
<% end %>